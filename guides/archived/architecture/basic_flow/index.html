<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/archived/architecture/basic_flow">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Basic Single Item Auction End To End | Metaplex Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.metaplex.com/guides/archived/architecture/basic_flow"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Basic Single Item Auction End To End | Metaplex Docs"><meta data-rh="true" name="description" content="Now that we&#x27;ve gone over the contracts, let&#x27;s run through an example of how the contracts interact to create an NFT and sell it. I personally find these stories the most informative way to learn a new ecosystem."><meta data-rh="true" property="og:description" content="Now that we&#x27;ve gone over the contracts, let&#x27;s run through an example of how the contracts interact to create an NFT and sell it. I personally find these stories the most informative way to learn a new ecosystem."><link data-rh="true" rel="icon" href="/logo/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.metaplex.com/guides/archived/architecture/basic_flow"><link data-rh="true" rel="alternate" href="https://docs.metaplex.com/guides/archived/architecture/basic_flow" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metaplex.com/guides/archived/architecture/basic_flow" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ONUK0F738E-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TNL3E6G9YK"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TNL3E6G9YK",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Metaplex Docs" href="/opensearch.xml">
<script src="https://app.happyreact.com/widget/reactions.js" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.118da3bc.css">
<link rel="preload" href="/assets/js/runtime~main.96711942.js" as="script">
<link rel="preload" href="/assets/js/main.f9f50fc6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/meta-white.svg" alt="Metaplex logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/logo/meta-black.svg" alt="Metaplex logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Metaplex Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/metaplex-foundation/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/programs/">Programs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Programs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/sdks/">SDKs</a><button aria-label="Toggle the collapsible sidebar category &#x27;SDKs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/developer-tools/">Developer Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/guides/">Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/candy-machine-ui">How to set up a Minting UI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/cli-wallet">How to set up a CLI Wallet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/mint-lists">How to get Your Mint List</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/airdrops">How to Airdrop Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/burn-nfts">How to burn NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/community">Community Guides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/fusion">How to use Metaplex Fusion</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/guides/archived">Archived</a><button aria-label="Toggle the collapsible sidebar category &#x27;Archived&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/guides/archived/architecture/overview">Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/archived/architecture/contracts">The Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/archived/architecture/basic_flow">Basic Single Item Auction End To End</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/guides/archived/architecture/deep_dive/overview">Deep Dive</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deep Dive&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/archived/burn-token">Burn Token</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/resources/">Resources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Resources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/deprecated/">Deprecated</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deprecated&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contact">Contact Us</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/guides/"><span itemprop="name">Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/guides/archived"><span itemprop="name">Archived</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/guides/archived/architecture/overview"><span itemprop="name">Architecture</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Basic Single Item Auction End To End</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Basic Single Item Auction End To End</h1><p>Now that we&#x27;ve gone over the contracts, let&#x27;s run through an example of how the contracts interact to create an NFT and sell it. I personally find these stories the most informative way to learn a new ecosystem.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-minting-an-nft">1. Minting an NFT<a href="#1-minting-an-nft" class="hash-link" aria-label="Direct link to 1. Minting an NFT" title="Direct link to 1. Minting an NFT">​</a></h3><p>On the Solana network an NFT is represented as a Token with only 1 in circulation and further minting is disabled, but that&#x27;s not very useful. A token contains very little data about itself. In fact, it doesn&#x27;t even know its own name. Solana tokens are a primitive construct that we build on top of. That&#x27;s where Metaplex comes in. As we mentioned on our <a href="/resources/definitions#non-fungible-tokens">Definitions Page</a> Metaplex is the standard way to add metadata to tokens. This metadata allows the tokens to secure Images, Audio, Video and anything else you can dream up. In order to create an NFT using metaplex we will follow these steps:</p><ol><li>Optional: Pay for the Upload</li><li>Creating a Token Mint</li><li>Optional: Creating A Token Associated Account - This is a special type of account that allows you to receive a token or tokens made by a mint.</li><li>Creating A Token Metadata Account</li><li>Upload the Files</li><li>Mint one Token</li><li>Create Master Edition</li></ol><p>We are breaking these steps down to make it easier to follow. Steps 1-4 happen as one Transaction on the Solana network, and Steps 6-7 are also just one transaction. Let&#x27;s dive into each step.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pay-for-the-upload">Pay For the Upload<a href="#pay-for-the-upload" class="hash-link" aria-label="Direct link to Pay For the Upload" title="Direct link to Pay For the Upload">​</a></h4><p>Ironically, the actual file upload is one of the last things to happen. Nothing is free, and uploading NFT content is no exception, so we currently need a way to pay for the file(s) to be stored on Arweave. To do this we need to transfer lamports(tiny fractions of a SOL token) to a specific wallet address. This wallet address is connected to a Web2 web application that handles the file upload and the payment to Arweave. This step is only needed in the frontend, as you can specify the URI without going through Arweave</p><p>Here is a visual representation of what happened</p><div class="mermaid">sequenceDiagram
   actor Client
   Client-&gt;&gt;+SYSTEM_PROGRAM: Transfer AR Upload Cost
   SYSTEM_PROGRAM-&gt;&gt;-AR_HOLDER_ADDRESS: Transfer Lamports</div><blockquote><p>NOTE: This approach is more centralized than many would prefer, Metaplex hopes to improve this and make it more decentralized, and remember there is nothing stopping you from hosting your NFT content differently. Metaplex is open source so change it and make it better for everyone.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-token-mint">Creating the Token Mint<a href="#creating-the-token-mint" class="hash-link" aria-label="Direct link to Creating the Token Mint" title="Direct link to Creating the Token Mint">​</a></h4><p>A token mint is how you make tokens, a mint that has a supply of 1 only allows you to make one token. When we make the mint, we are not actually making the token, but a container that can make tokens. In Solana, accounts are like containers for data, like a file. To create a mint you need to create an account in Solana that &quot;holds&quot; the mint.</p><p>Adding to our diagram we see the Mint created.</p><div class="mermaid">sequenceDiagram
   actor Client
   Client-&gt;&gt;+SYSTEM_PROGRAM: Transfer AR Upload Cost
   SYSTEM_PROGRAM-&gt;&gt;-AR_HOLDER_ADDRESS: Transfer Lamports
   Client-&gt;&gt;+SYSTEM_PROGRAM: Create an Account Owned by the System Program
   SYSTEM_PROGRAM-&gt;&gt;-Client: Token Account
   Client-&gt;&gt;+SPL_TOKEN_PROGRAM: Create A Token Mint with the public key of the Token Account
   SPL_TOKEN_PROGRAM-&gt;&gt;-Client: Token Mint</div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="optional-creating-a-token-associated-account">Optional: Creating A Token Associated Account<a href="#optional-creating-a-token-associated-account" class="hash-link" aria-label="Direct link to Optional: Creating A Token Associated Account" title="Direct link to Optional: Creating A Token Associated Account">​</a></h4><p>This step is necessary only when your wallet will need to hold the Token after the first MasterEdition (we will get to this later) or Prints become minted. On the Metaplex frontend, currently this is needed when you are manually uploading and creating an NFT. Without this Account your wallet could not receive the Token.
We keep adding to our diagram to show the Token Associated Account creation.</p><div class="mermaid">sequenceDiagram
   actor Client
   Client-&gt;&gt;+SYSTEM_PROGRAM: Transfer AR Upload Cost
   SYSTEM_PROGRAM-&gt;&gt;-AR_HOLDER_ADDRESS: Transfer Lamports
   Client-&gt;&gt;+SPL_TOKEN_PROGRAM: Create A Token Mint
   SPL_TOKEN_PROGRAM-&gt;&gt;-Client: Token Mint
   Client-&gt;&gt;+SPL_TOKEN_ASSOCIATED_PROGRAM: Create Token Account
   SPL_TOKEN_ASSOCIATED_PROGRAM-&gt;&gt;-Client: Token Account</div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-token-metadata-account">Creating A Token Metadata Account<a href="#creating-a-token-metadata-account" class="hash-link" aria-label="Direct link to Creating A Token Metadata Account" title="Direct link to Creating A Token Metadata Account">​</a></h4><p>As we said above the steps we have gone through thus far are represented as one transaction on the Solana network. These are called instructions, and this is the last set of instructions before we hit the network. This step is the backbone of Metaplex. This allows us to store additional information with a Token. There are a lot of variables needed to execute these set of instructions, let&#x27;s go through them. In the frontend, the uris are blank and then updated after the actual upload to ARWEAVE succeeds.</p><ol><li>The Data - this is a blob of data that conforms to the <a href="/programs/token-metadata/token-standard">Token Metadata Standard</a>.</li><li>Your Public Key</li><li>A Metadata program Derived account Address - Read more about PDAs here. This is an uninitialized address that the account will be stored at. We do this so we can deterministically find this address again in the future.</li><li>The mint account public key</li></ol><p>Let&#x27;s look at an in depth diagram of the CreateAccountMetadata program and what it does.</p><div class="mermaid">sequenceDiagram
   actor Client
   Client-&gt;&gt;+METAPLEX_TOKEN_METADATA_PROGRAM: Send all the Accounts and Data
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;SYSTEM_PROGRAM: Create Account with PDA
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;SYSTEM_PROGRAM: Transfer Lamports to Metaplex Metadata Mint PDA to store data
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;SYSTEM_PROGRAM: Allocate space in Metaplex Metadata Mint PDA
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;-SYSTEM_PROGRAM: Assign Ownership of the Account to Metadata Program</div><p>This adds to our ever-growing diagram to complete Transaction 1.</p><div class="mermaid">sequenceDiagram
   actor Client
   Client-&gt;&gt;+SYSTEM_PROGRAM: Transfer AR Upload Cost
   SYSTEM_PROGRAM-&gt;&gt;-AR_HOLDER_ADDRESS: Transfer Lamports
   Client-&gt;&gt;+SPL_TOKEN_PROGRAM: Create A Token Mint
   SPL_TOKEN_PROGRAM-&gt;&gt;-Client: Token Mint
   Client-&gt;&gt;+SPL_TOKEN_ASSOCIATED_PROGRAM: Create Token Account
   SPL_TOKEN_ASSOCIATED_PROGRAM-&gt;&gt;-Client: Token Account
   Client-&gt;&gt;+METAPLEX_TOKEN_METADATA_PROGRAM: Send all the Accounts and Data</div><p>All of these instructions are bundled up into one transaction and sent over RPC to the Solana network. At the end of this transaction you have completed steps 1-4 and the transaction id that you get back from the network will help you in the next step.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="upload-the-files">Upload the Files<a href="#upload-the-files" class="hash-link" aria-label="Direct link to Upload the Files" title="Direct link to Upload the Files">​</a></h4><p>If you are using the frontend, after the above transaction succeeds you will get a Transaction ID. This ID will then be used as a credential to the Web2 uploading system. This system checks the transaction id, mint key and files for validity and size. It then uploads them to arweave and finishes paying arweave out of the SOL you transferred to the special upload wallet.</p><div class="mermaid">sequenceDiagram
    actor Client
    Client-&gt;&gt;+Uploader: Send files through web2 server with transaction hash as credential
    Uploader--&gt;&gt;+Arweave: Upload to arweave
    Arweave--&gt;&gt;-Uploader: Upload to arweave
    Uploader-&gt;&gt;+Client: Return Json URI and Binary URIs
    Client-&gt;&gt;+METAPLEX_TOKEN_METADATA_PROGRAM: Update metadata to have correct URIs</div><p>If you are not using the frontend then this step may not be necessary for you.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mint-one-token">Mint One Token<a href="#mint-one-token" class="hash-link" aria-label="Direct link to Mint One Token" title="Direct link to Mint One Token">​</a></h4><p>Finally, the mint! We will now begin building the second transaction starting with the <code>MintTo</code> instruction. MintTo needs to be passed some data in order to function, it needs the following:</p><ol><li>The Mint address - this is the public key of the account we made to store the mint.</li><li>The destination address - this is that PDA(Program Derived Address) that we used to store the Token MetaData, and it is now the address or public key of the Token Metadata Account.</li><li>Your public key - since you are the Minting Authority or Owner of the mint, you have the ability to mint.</li><li>An amount, in this case 1</li></ol><p>We will start fresh with our transaction diagram.</p><div class="mermaid">sequenceDiagram
    actor Client
    Client-&gt;&gt;+SPL_TOKEN_PROGRAM: Mint 1 token and send it to the PDA</div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-master-edition">Create Master Edition<a href="#create-master-edition" class="hash-link" aria-label="Direct link to Create Master Edition" title="Direct link to Create Master Edition">​</a></h4><p>In Metaplex, you can make an NFT that is a true one-of-a-kind token, but you can also use the <code>MasterEdition</code> construct to create <code>Prints</code> of the master edition, just like a painting. You now want to label this token account as a MasterEdition NFT that has a limited supply of 10 possible Limited Edition Prints. Cool! Remember that the point of Metadata is to label mints - not just NFTs. To do this you call the <code>create_master_edition</code> endpoint on the Token Metadata Program. By doing this, minting authority is taken away from you, and it creates a new Master Edition PDA that contains information about how large a supply you want to have.</p><p>Let&#x27;s do a deep dive on this Program.</p><div class="mermaid">sequenceDiagram
   actor Client
   Client-&gt;&gt;+METAPLEX_TOKEN_METADATA_PROGRAM: Create Master Edition
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;SYSTEM_PROGRAM: Create Account with Mint Master Edition PDA
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;SYSTEM_PROGRAM: Transfer Lamports to Mint Master Edition PDA to store data
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;SYSTEM_PROGRAM: Allocate space in Mint Master Edition PDA
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;-SYSTEM_PROGRAM: Assign Ownership of the Account to Metadata Program
   METAPLEX_TOKEN_METADATA_PROGRAM--&gt;&gt;+SPL_TOKEN_PROGRAM: Transfer Mint Authority of the Mint to the Mint Master Edition PDA</div><p>When you want to mint Editions now, you&#x27;ll need to present a token account containing the token from this Master Edition mint as proof of ownership and authority to do so. This is why we will later hand this token over to the Auction Manager, so that it can do the same to print off Editions for winners!</p><p>Let&#x27;s take a look at our transaction diagram now.</p><div class="mermaid">sequenceDiagram
    actor Client
    Client-&gt;&gt;+SPL_TOKEN_PROGRAM: Mint 1 token and send it to the PDA
    Client-&gt;&gt;+METAPLEX_TOKEN_METADATA_PROGRAM: Create Master Edition</div><p>The above instructions will get bundled up into one instruction and sent to the Solana network. Once successful your token account has a bona-fide NFT Master Edition in it, we can run an auction where we auction off Limited Edition prints! Let&#x27;s say we want to auction off three such prints.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-the-auction">2. The Auction<a href="#2-the-auction" class="hash-link" aria-label="Direct link to 2. The Auction" title="Direct link to 2. The Auction">​</a></h3><ol start="5"><li><p>Next, we create a token vault using the <code>init_vault</code> endpoint of the token vault contract. We&#x27;ll store our master edition token in it by adding it to the vault using the <code>add_token_to_inactive_vault</code> endpoint. This will create a safety deposit box in the vault that contains the token.</p></li><li><p>Then we will call the <code>activate_vault</code> command which <strong>Activates</strong> the vault, locking everything inside.</p></li><li><p>We now <strong>Combine</strong> the vault using <code>combine_vault</code>, which is to say, we &quot;open it,&quot; so the current authority could, if they wanted, withdraw the tokens inside it. The Auction Manager can only work with vaults in this state, which is why we have to go through the <strong>Activation</strong> phase to get here even though it seems a little nonsensical. <a href="/guides/archived/architecture/deep_dive/token_vault">See the in depth guide</a> for more color on why these different states exist.</p></li><li><p>Next up, we create the auction, and we say its resource is this vault. The auction has not yet been started, but it has the right resource (the vault). We do this via the <code>create_auction</code> command on the Auction contract.</p></li><li><p>Now that we have an auction and a vault, we can go and call the <code>init_auction_manager</code> endpoint on the Metaplex contract with both of these accounts among a few others to create an AuctionManager, which ties them both together. Note that <code>init_auction_manager</code> takes a special struct called AuctionManagerSettings that allows one to specify how many winners there are and what winners get which items from which safety deposit box. At this point, we can&#x27;t yet start the auction. The AuctionManager is in an invalidated state, and we need to validate it. We do this by validating that the safety deposit boxes we provided to it in the vault have actually what we said are in them when we provided the AuctionManager with its settings struct.</p></li><li><p>Before we begin validation, we call <code>set_authority</code> on both the vault and auction to change its authority to the auction manager, so that it has control over both of those structs. This is a requirement for the validation phase and the rest of the contract lifecycle. <strong>Now you no longer have control over your items.</strong></p></li><li><p>We call the <code>validate_safety_deposit_box</code> endpoint on the Metaplex contract with the one safety deposit box in the vault, and the logic in this endpoint checks that there are exactly 3 printing tokens from the right mint in this box, matching the 3 printing tokens we promised it would have in our AuctionManagerSettings. Once we do this, and because this is the only safety deposit box in the vault, the AuctionManager is now validated.</p></li><li><p>We now call <code>start_auction</code> on the Metaplex contract, which, because the AuctionManager has authority over the Auction, calls <code>start_auction</code> on the Auction contract, and the auction begins!</p></li><li><p>Users can go and call <code>place_bid</code> on the Auction contract to place bids. When they do this, tokens of the <code>token_mint</code> type used by the auction are taken from the account they provide, tied to their main wallet, and stored in bidder pot accounts in the auction contract.</p></li><li><p>In order to update a bid, a user must first cancel the original bid, and then place a new bid.</p></li><li><p>Once the auction is over, a user can refund their bid if they did not win by calling <code>cancel_bid</code> again. Winners of the auction cannot cancel their bids.</p></li><li><p>The winner of a bid creates a mint with decimals 0, a token account with 1 token in it, and calls the <code>redeem_printing_v2_bid</code> endpoint on the Metaplex contract, all in a single transaction. This token is now <em>officially</em> a Limited Edition of the &quot;Bob&#x27;s Cool NFT&quot; Master Edition NFT!</p></li><li><p>You, the auctioneer, visit /#/auction/id/billing and hit the settle button. This first iterates over all three bidders and for each wallet used, calls <code>claim_bid</code> on the Metaplex contract, which proxy-calls a <code>claim_bid</code> on the Auction contract, telling it to dump the winner&#x27;s payment into an escrow account called <code>accept_payment</code> on the AuctionManager struct. It has the same token type as the auction. Once all payments have been collected, the front-end then calls the <code>empty_payment_account</code> endpoint one time (since you are the only creator on the Metadata being sold) and the funds in this escrow are paid out to a token account provided of the same type owned by you.</p><p>Note that our front-end reference implementation uses SOL as the &quot;token type.&quot; This has some special caveats, namely that SOL isn&#x27;t really an &quot;spl token.&quot; It instead has a work-around called the &quot;Wrapped SOL mint.&quot; This is a special mint that is often used in a transient account. What this means is that when we place a bid, we actually make a one-off system account, transfer lamports to it of your bid amount + rent, then label it an spl-token account of the wrapped sol type, use it to place the bid, then close it all in one transaction.</p><p>Special machinations in the spl token program then make this wrapped sol token account have a number of tokens with the proper decimals that map to the amount of SOL you transferred to it. We do a similar operation with cancelling, where we make a transient wrapped sol account, transfer cancelled bid funds to it, and then close the account, transferring funds out all in a single transaction. This is all done for ease of use. With settlements, when funds are disbursed to artists, we actually make a wSOL account for them, and they have to close it by hand via a dropdown menu.</p><p>The protocol operates off of generic spl tokens and has no opinions about wSOL specifically, but the front-end reference implementation does. So take careful note!</p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/metaplex/docs/tree/main/docs/04-guides/07-archived/00-architecture/01-basic_flow.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-07-10T10:16:28.000Z">Jul 10, 2023</time></b></span></div></div><div><div class="feedbackWidget"><h3>Was this page helpful?</h3><div class="widget_UOf8" data-hr-token="8c828a21-ead0-4998-b98b-f465fd3e4e4f" data-hr-resource="guides-archived-architecture-basic_flow" data-hr-styles="{&quot;grid&quot;:&quot;grid_uXr7&quot;,&quot;cell&quot;:&quot;cell_NyhG&quot;,&quot;reaction&quot;:&quot;reaction_jDJL&quot;,&quot;footer&quot;:&quot;footer_VuXo&quot;}" data-hr-strategy="instant"></div></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/guides/archived/architecture/contracts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The Contracts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/guides/archived/architecture/deep_dive/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-minting-an-nft" class="table-of-contents__link toc-highlight">1. Minting an NFT</a></li><li><a href="#2-the-auction" class="table-of-contents__link toc-highlight">2. The Auction</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/metaplex" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/metaplex" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://solana.stackexchange.com/questions/tagged/metaplex" target="_blank" rel="noopener noreferrer" class="footer__link-item">StackExchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/metaplex-foundation/metaplex" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Powered by</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://happyreact.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Happy React<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Metaplex</div></div></div></footer></div>
<script src="/assets/js/runtime~main.96711942.js"></script>
<script src="/assets/js/main.f9f50fc6.js"></script>
</body>
</html>